name: root
template: |
    {% set i = "0" %}
    {% import "./child1" as ch1 %}
    {% import "./child2" as ch2 %}
    {% import "./child3" as ch3 %}
    {% import "./child3/grandchild1" as gch31 %}
    # template {{i}}
    * child1.i = {{ch1.i}}
    * child2.i = {{ch2.i}}
    * child3.i = {{ch3.i}}
    * child3.grandchild1.i = {{gch31.i}}
children:

    -   name: child1
        template: |
            {% set i = "1" %}
            # template {{i}}
            * {{grandchild1.i}}
            * {{grandchild2.i}}
            * {{grandchild3.i}}
        children:

            -   name: grandchild1
                template: |
                    {% set i = "1.1" %}
                    # template {{i}}
                children: []

            -   name: grandchild2
                template: |
                    {% set i = "1.2" %}
                    # template {{i}}
                children: []

            -   name: grandchild3
                template: |
                    {% set i = "1.3" %}
                    # template {{i}}
                children: []

    -   name: child2
        template: |
            {% set i = "2" %}
            # template {{i}}
            * {{grandchild1.i}}
            * {{grandchild2.i}}
            * {{grandchild3.i}}
        children:

            -   name: grandchild1
                template: |
                    {% set i = "2.1" %}
                    # template {{i}}
                children: []

            -   name: grandchild2
                template: |
                    {% set i = "2.2" %}
                    # template {{i}}
                children: []

            -   name: grandchild3
                template: |
                    {% set i = "2.3" %}
                    # template {{i}}
                children: []

    -   name: child3
        template: |
            {% set i = "3" %}
            # template {{i}}
            * {{grandchild1.i}}
            * {{grandchild2.i}}
            * {{grandchild3.i}}
        children:

            -   name: grandchild1
                template: |
                    {% set i = "3.1" %}
                    # template {{i}}
                children: []

            -   name: grandchild2
                template: |
                    {% set i = "3.2" %}
                    # template {{i}}
                children: []

            -   name: grandchild3
                template: |
                    {% set i = "3.3" %}
                    # template {{i}}
                children: []
